<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Flashback Stack</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            background: #f0f0f0;
            font-family: 'Helvetica', sans-serif;
            overflow-y: auto;
            touch-action: none; /* Prevents default touch scrolling */
        }

        .container {
            position: relative;
            width: 100%;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px 0;
        }

        .square {
            width: 80%;
            max-width: 300px;
            padding: 20px;
            border-radius: 10px;
            color: white;
            font-size: 18px;
            text-align: center;
            position: absolute;
            cursor: grab;
            user-select: none;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            transition: transform 0.3s ease-in-out;
        }

        .square.active {
            background: linear-gradient(135deg, #00d4ff, #ffeb3b);
            z-index: 10;
        }

        .square.locked {
            background: linear-gradient(135deg, #26a69a, #4fc3f7);
            cursor: default;
        }

        .tap-button {
            position: fixed;
            bottom: 20px;
            width: 50px;
            height: 50px;
            background: #ff5722;
            border-radius: 50%;
            color: white;
            font-size: 14px;
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
            transition: opacity 0.2s;
            z-index: 20;
        }

        .tap-button.visible {
            opacity: 1;
            animation: pulse 1s infinite;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }

        .score {
            position: absolute;
            font-size: 40px;
            font-weight: bold;
            z-index: 15;
            pointer-events: none;
        }

        .score.correct {
            color: #4caf50;
            animation: scoreUp 1s ease-out forwards;
        }

        .score.incorrect {
            color: #f44336;
            animation: scoreShake 0.5s ease-out forwards;
        }

        @keyframes scoreUp {
            0% { opacity: 1; transform: translateY(0); }
            100% { opacity: 0; transform: translateY(-50px); }
        }

        @keyframes scoreShake {
            0% { opacity: 1; transform: translateX(0); }
            25% { transform: translateX(-10px); }
            50% { transform: translateX(10px); }
            75% { transform: translateX(-10px); }
            100% { opacity: 0; transform: translateX(0); }
        }
    </style>
</head>
<body>
    <div class="container" id="gameContainer"></div>
    <div class="tap-button" id="tapButton">Tap</div>

    <script>
        const container = document.getElementById('gameContainer');
        const tapButton = document.getElementById('tapButton');
        let activeSquare = null;
        let squares = [];
        let score = 0;

        // Sample trivia data with correct positions (y-coordinates)
        const triviaData = [
            { text: "This band broke up in 1970", correctY: 400 },
            { text: "This console launched in 2006", correctY: 300 },
            { text: "This movie won Best Picture in 2004", correctY: 200 },
            { text: "This gadget launched in 1997", correctY: 100 }
        ];

        // Initialize game
        function startGame() {
            addSquare(0);
        }

        // Add a new square
        function addSquare(index) {
            if (index >= triviaData.length) return;

            const square = document.createElement('div');
            square.classList.add('square', 'active');
            square.innerText = triviaData[index].text;
            square.dataset.index = index;
            square.style.left = `${(window.innerWidth - 300) / 2}px`; // Center horizontally
            square.style.top = `${100}px`; // Start above previous squares
            container.appendChild(square);
            squares.push(square);
            activeSquare = square;

            // Touch events
            square.addEventListener('touchstart', onTouchStart);
            square.addEventListener('touchmove', onTouchMove);
            square.addEventListener('touchend', onTouchEnd);
        }

        // Touch handling
        function onTouchStart(e) {
            e.preventDefault();
            activeSquare.style.transition = 'none';
        }

        function onTouchMove(e) {
            e.preventDefault();
            const touch = e.touches[0];
            const x = touch.clientX - activeSquare.offsetWidth / 2;
            const y = touch.clientY - activeSquare.offsetHeight / 2;
            activeSquare.style.left = `${x}px`;
            activeSquare.style.top = `${y}px`;
        }

        function onTouchEnd(e) {
            e.preventDefault();
            tapButton.classList.add('visible');
            tapButton.onclick = () => placeSquare();
        }

        // Place square and check correctness
        function placeSquare() {
            tapButton.classList.remove('visible');
            const index = parseInt(activeSquare.dataset.index);
            const correctY = triviaData[index].correctY;
            const currentY = parseInt(activeSquare.style.top);

            const tolerance = 50;
            const isCorrect = Math.abs(currentY - correctY) <= tolerance;

            showScore(isCorrect, activeSquare);
            activeSquare.classList.remove('active');
            activeSquare.classList.add('locked');

            if (!isCorrect) {
                activeSquare.style.transition = 'top 0.5s ease-in-out';
                activeSquare.style.top = `${correctY}px`;
            }

            activeSquare = null;
            setTimeout(() => addSquare(index + 1), 1000); // Add next square after delay
        }

        // Show score animation
        function showScore(isCorrect, square) {
            const scoreEl = document.createElement('div');
            scoreEl.classList.add('score');
            scoreEl.classList.add(isCorrect ? 'correct' : 'incorrect');
            scoreEl.innerText = isCorrect ? '+10' : '0';
            scoreEl.style.left = `${parseInt(square.style.left) + square.offsetWidth / 2 - 20}px`;
            scoreEl.style.top = `${parseInt(square.style.top) + square.offsetHeight / 2 - 20}px`;
            container.appendChild(scoreEl);

            if (isCorrect) score += 10;

            setTimeout(() => scoreEl.remove(), 1000); // Clean up after animation
        }

        // Start the game
        startGame();
    </script>
</body>
</html>
